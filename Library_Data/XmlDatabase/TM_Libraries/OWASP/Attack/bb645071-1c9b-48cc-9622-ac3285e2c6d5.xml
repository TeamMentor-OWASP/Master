<?xml version="1.0" encoding="utf-8"?>
<guidanceItem id="bb645071-1c9b-48cc-9622-ac3285e2c6d5" Author="" Category="Cryptography" Priority="2" Rule_Type="Attack" Status="" Technology=" Any" title="Chosen Plaintext Attack" Topic="Security" phase="Any" xmlns="urn:microsoft:guidanceexplorer:guidanceItem">
  <content>&lt;br&gt;&lt;br&gt;&lt;h1&gt;Applies To&lt;/h1&gt;&lt;p&gt;Applications that use encryption.&lt;/p&gt;&lt;h1&gt;Description&lt;/h1&gt;&lt;p&gt;A chosen plaintext attack (CPA) is a form of &lt;a href="http://en.wikipedia.org/wiki/Cryptanalysis"&gt;cryptanalysis&lt;/a&gt; where it is assumed that the attacker has access to a device that provides her the capability to choose arbitrary plaintexts to be encrypted and obtain the corresponding ciphertexts.&lt;/p&gt;&lt;p&gt;An attacker with such capabilities will perform the encryption of selected plaintexts and then analyze the resulting ciphertext in order to gain some further information that reduces the security of the encryption scheme. In the worst case, a chosen plaintext attack could reveal the scheme's secret key.&lt;/p&gt;&lt;h1&gt;Impact&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;Disclosure of sensitive data &lt;/li&gt;&lt;/ul&gt;&lt;h1&gt;Vulnerabilities&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;Custom implementation of algorithm. &lt;/li&gt;&lt;li&gt;Use of weak keys (e.g., a short key length). &lt;/li&gt;&lt;li&gt;Exposing cipher text unnecesarily. &lt;/li&gt;&lt;li&gt;Allowing an attacker to submit arbitrary data for encryption.&lt;/li&gt;&lt;/ul&gt;&lt;h1&gt;Countermeasures&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;Use well-known implementations of well-known cryptographic algorithms. &lt;/li&gt;&lt;li&gt;Use cryptographically generated random keys. &lt;/li&gt;&lt;li&gt;Use large keys (128-bit symmetric or 1024-bit asymmetric keys). &lt;/li&gt;&lt;li&gt;Utilize platform supplied features to store secret keys. &lt;/li&gt;&lt;li&gt;Follow principle of least privilege to provide limited access to the secret key. &lt;/li&gt;&lt;li&gt;Maintain key outside of the application domain (e.g., for a Web server, keep the key outside of the webroot). &lt;/li&gt;&lt;li&gt;If using a symmetric cipher, utilize a unique random IV to hide the underlying character pattern of the plain text and use a chaining mode to prevent the replacement of individual blocks of the cyphertext. &lt;/li&gt;&lt;li&gt;If using a cryptographic hash algorithm, salt the hash value with a unique random bit stream.&lt;/li&gt;&lt;/ul&gt;&lt;h1&gt;Additional Resources&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;For more information on this attack, please see &lt;a href="http://en.wikipedia.org/wiki/Chosen_plaintext_attack"&gt;http://en.wikipedia.org/wiki/Chosen_plaintext_attack&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h1&gt;Related Items&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="ruledisplay:3B657A67-F660-4DB5-9267-6E0FE2DAA1EB"&gt;Attack: Chosen Ciphertext Attack&lt;/a&gt; &lt;/li&gt;&lt;li&gt;&lt;a href="ruledisplay:24D078E3-A02F-4EDF-A6EA-DA0E3E5FFE5E"&gt;Attack: Key Bruteforce Attack&lt;/a&gt; &lt;/li&gt;&lt;li&gt;&lt;a href="ruledisplay:13EE90D9-B0F6-45D6-913A-BA8527525A04"&gt;Attack: Traffic Analysis Attack&lt;/a&gt; &lt;/li&gt;&lt;li&gt;&lt;a href="ruledisplay:4572037A-2166-4AD1-8E73-D623E468A7B9"&gt;Attack: Information Disclosure Attack&lt;/a&gt; &lt;/li&gt;&lt;li&gt;&lt;a href="ruledisplay:A2E3F1BD-31BC-41BF-B147-C314A87C2172"&gt;Attack: Statistical Analysis Attack&lt;/a&gt; &lt;/li&gt;&lt;li&gt;&lt;a href="ruledisplay:5C9F30DE-BD35-4544-87C4-1D2E56D603A0"&gt;Attack: Timing Analysis Attack&lt;/a&gt; &lt;/li&gt;&lt;li&gt;&lt;a href="ruledisplay:23F61C2C-53E5-4FCD-9AB4-4182DBC19D6D"&gt;Attack: Sniff Memory for Secrets Attack&lt;/a&gt; &lt;/li&gt;&lt;li&gt;&lt;a href="ruledisplay:EA8E596E-3498-4DA4-A4C7-55AAAB28B807"&gt;Guideline: Encrypt Sensitive Data in the Database &lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="ruledisplay:3DC61B01-7418-4CF8-A193-BF968471796A"&gt;Guideline: Store Passwords Securely &lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="ruledisplay:AE7F27AF-7253-462F-8A29-6AB2AA202C05"&gt;Guideline: Encrypt Communication Links &lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="ruledisplay:440137A2-948A-4485-A137-E3CC8207F801"&gt;Guideline: Use a Secure Key Storage Location &lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</content>
</guidanceItem>