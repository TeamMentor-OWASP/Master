<?xml version="1.0" encoding="utf-8"?>
<guidanceItem id="5ce93f58-53f1-4cb6-acac-b15f71b79bc7" 
               Author="" 
               Category="Authentication" 
               Priority="2" 
               Rule_Type="Checklist Item" 
               Status="" 
               Technology="Java" 
               title="Access to the Credential Store is Limited" 
               Topic="Security" 
               phase="Implementation" 
               xmlns="urn:microsoft:guidanceexplorer:guidanceItem">
  <content>&lt;h1&gt;What to Check For&lt;/h1&gt;&lt;p&gt;Ensure that access to the credential store is limited to administrators with the correct privileges. &lt;/p&gt;&lt;h1&gt;Why&lt;/h1&gt;&lt;p&gt;Unauthorized access to the credential store can lead to users' credentials being overwritten; therefore, allowing the attacker to gain access to application resources without obtaining valid credentials prior to the attack.&lt;/p&gt;&lt;h1&gt;How to Check&lt;/h1&gt;&lt;p&gt;Follow these steps to ensure that the credential store is properly secured: &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Identify all routines that access the store. &lt;/strong&gt;Locate all routines within your application that access the credential store. Such routines include:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Authenticating users &lt;/li&gt;&lt;li&gt;Creating users &lt;/li&gt;&lt;li&gt;Modifying users &lt;/li&gt;&lt;li&gt;Changing user passwords&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Verify that credentials for accessing the store are secured. &lt;/strong&gt;Ensure that your application's access credentials and connection strings are not hard-coded into your application's code base. &lt;/p&gt;&lt;ul&gt;&lt;li&gt;If your application &lt;strong&gt;uses a database&lt;/strong&gt; for its credential repository, follow the &lt;a href="ruledisplay:347C1DE9-9132-4B10-9523-64059EAA9F48"&gt;Connection Strings are Secured&lt;/a&gt; checklist to ensure that access credentials and connection strings are secured properly. &lt;/li&gt;&lt;li&gt;If your application &lt;strong&gt;does not use a database&lt;/strong&gt; for its credential repository, consult the &lt;a href="ruledisplay:FA468EF2-F27F-40B8-BD43-302F66AA9C26"&gt;Plaintext Sensitive Data is Not Stored&lt;/a&gt; checklist. Verify that only the appropriate components of your application are able to access the credential store.&lt;br&gt;&lt;br&gt;Example of how &lt;strong&gt;not&lt;/strong&gt; to handle access to the credential store: &lt;/li&gt;&lt;/ul&gt;&lt;br&gt;&lt;blockquote&gt;&lt;blockquote&gt;&lt;pre&gt;// The application discloses the credentials necessary for accessing the user database&lt;br&gt;DriverManager.registerDriver(new oracle.jdbc.driver.OracleDriver());&lt;br&gt;Connection cn = DriverManager.getConnection("jdbc:oracle:thin:@testbox:1521:orcl2", "myapp", "pass"); &lt;/pre&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Check the access controls for your credential store.&lt;/strong&gt; Ensure that your application's credential store has the appropriate security in place. For instance, if your application uses a database for its credential store, verify that the database server is secured properly.&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;ol&gt;&lt;/ol&gt;&lt;h1&gt;Problem Example&lt;/h1&gt;&lt;p&gt;The following code authenticates a user based on their credentials. Because the code discloses the credentials to the user database, anybody with access to the code also has&amp;nbsp;access to the credential store. &lt;/p&gt;&lt;blockquote&gt;&lt;pre&gt;public boolean validateUser(String user, char[] pass)&lt;br&gt; {&lt;br&gt;      boolean valid;&lt;br&gt;      Connection cn;&lt;br&gt;       // Prepare credentials before querying the credential store&lt;br&gt;      ...&lt;br&gt;       try&lt;br&gt;      {&lt;br&gt;            // The application discloses the credentials necessary for&lt;br&gt;            // accessing the user database&lt;br&gt;            DriverManager.registerDriver(new oracle.jdbc.driver.OracleDriver());&lt;br&gt;            cn = DriverManager.getConnection("jdbc:oracle:thin:@testbox:1521:orcl2",&lt;br&gt;                                              "myapp", "pass");&lt;br&gt;            // Query the credential store and perform the rest&lt;br&gt;            // of the authentication steps&lt;br&gt;            ...&lt;br&gt;      }&lt;br&gt;      catch (SQLException se)&lt;br&gt;      {&lt;br&gt;            // Add the appropriate logging and exception handling mechanisms&lt;br&gt;            return false;&lt;br&gt;      }&lt;br&gt;       return valid;&lt;br&gt;}&lt;/pre&gt;&lt;/blockquote&gt;&lt;h1&gt;Related Guideline&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="ruledisplay:AEE6B133-B34C-442F-9051-0D8DC51F072E"&gt;Guideline: Limit Access to the Credential Store (Java Web Application)&lt;/a&gt; &lt;/li&gt;&lt;/ul&gt;</content>
</guidanceItem>