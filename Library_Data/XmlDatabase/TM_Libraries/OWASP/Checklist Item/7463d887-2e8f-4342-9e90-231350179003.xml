<?xml version="1.0" encoding="utf-8"?>
<guidanceItem id="7463d887-2e8f-4342-9e90-231350179003" Author="" Category="Authorization" Priority="2" Rule_Type="Checklist Item" Status="" Technology="Java" title="Account Administration Is Separated from the Main Application Interface" Topic="Security" phase="Design" xmlns="urn:microsoft:guidanceexplorer:guidanceItem">
  <content>&lt;h1&gt;What to Check For&lt;/h1&gt;&lt;p&gt;Ensure that the account administration interface is separate from the main application interface.&lt;/p&gt;&lt;h1&gt;Why&lt;/h1&gt;&lt;p&gt;Account administration requires higher privileges than the main application interface. Separating the two interfaces decreases the risk of a normal user being able to escalate privileges to that of an administrator.&lt;/p&gt;&lt;h1&gt;How to Check&lt;/h1&gt;&lt;p&gt;Use the following steps to verify that the&amp;nbsp;account administration interface is separate from the main application interface: &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Verify that your application has a separate administrative interface. &lt;/strong&gt;Review your application's design and verify that your application's design specifies separation of administrative and main application interfaces. Verify that your application passes the following checks:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;strong&gt;Administrative Functionality&lt;/strong&gt;: Verify that all administrative functionality is clearly identified and separated from the rest of your application's functionality. Exceptions are allowed only when your application allows users to modify their own accounts. &lt;/li&gt;&lt;li&gt;&lt;strong&gt;Code Organization&lt;/strong&gt;: Ensure all administrative functionality is structured as a single module and not scattered throughout your application. &lt;/li&gt;&lt;li&gt;&lt;strong&gt;Code Inheritance&lt;/strong&gt;: Verify that all Java classes that handle your application's administrative tasks are declared as final. Example: &lt;br&gt;&lt;blockquote&gt;&lt;pre&gt;public final class myappAcctAdmin&lt;br&gt;{&lt;br&gt; ...&lt;br&gt;}&lt;/pre&gt;&lt;/blockquote&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Hosting Container&lt;/strong&gt;: Verify that all administrative functionality operates within a Java container or a JVM that is separate from the rest of your application. Depending on the application server that your application uses, it might be necessary to run multiple instances of the application server. Additionally, check if your administrative interface operates on a different port than the rest of your application (e.g. port 3128).&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Ensure that the administrative interface is secure. &lt;/strong&gt;Use the following steps to examine the security of your application's administrative interface:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;strong&gt;Security Policy&lt;/strong&gt;: Ensure that your application has a security policy regarding its administrative interface. &lt;/li&gt;&lt;li&gt;&lt;strong&gt;Separate Authentication&lt;/strong&gt;: Verify that privileged users are forced to re-authenticate before accessing the administrative interface. Check if your application's administrative interface uses a separate authentication module&amp;nbsp;from the rest of your application. &lt;/li&gt;&lt;li&gt;&lt;strong&gt;Access Controls&lt;/strong&gt;: Using the &lt;a href="ruledisplay:C9F50A0D-15D4-4E10-AACA-D374F24974D2"&gt;Test Accounts are Removed&lt;/a&gt; checklist, verify that only valid, privileged users can access your application's administrative interface. &lt;/li&gt;&lt;li&gt;&lt;strong&gt;Connection&lt;/strong&gt;: Depending on your application's requirements, it may be necessary to check if your application's administrative interface is utilizing SSL. Use the &lt;a href="ruledisplay:AFC86927-1116-4207-B604-55FE690C298B"&gt;Communication Links are Encrypted&lt;/a&gt; checklist to ensure your application's proper use of SSL.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h1&gt;Problem Example&lt;/h1&gt;&lt;p&gt;The following code shows the navigation bar for an administrative account of the application. Because the administrative code is not separated from the application, an administrator can use a single session to use and administer the application. Therefore, a vulnerability such as cross-site scripting in the main application interface will expose the administrative interface as well.&lt;/p&gt;&lt;pre&gt;&amp;lt;td valign=top width=150 bgcolor="#e5e5e5"&amp;gt;&lt;br&gt;  &amp;lt;b&amp;gt;::rates&amp;lt;/b&amp;gt;&lt;br&gt;  &amp;lt;br&amp;gt;&amp;lt;a href="http://serv02.example.com/analyzeRates.do?action=browse"&amp;gt;browse rates&amp;lt;/a&amp;gt;&lt;br&gt;  &amp;lt;br&amp;gt;&amp;lt;a href="http://serv02.example.com/manageRates.do?action=add"&amp;gt;add rates&amp;lt;/a&amp;gt;&lt;br&gt;  &amp;lt;br&amp;gt;&amp;lt;a href="http://serv02.example.com/manageRates.do?action=import"&amp;gt;import rates&amp;lt;/a&amp;gt;&lt;br&gt;  &amp;lt;br&amp;gt;&amp;lt;a href="http://serv02.example.com/manageRates.do?action=export"&amp;gt;export rates&amp;lt;/a&amp;gt;&lt;br&gt;  &amp;lt;br&amp;gt;  &amp;lt;p&amp;gt;&amp;lt;b&amp;gt;::acct management&amp;lt;/b&amp;gt;&lt;br&gt;  &amp;lt;br&amp;gt;&amp;lt;a href="http://serv02.example.com/manageUsers.do?action=add"&amp;gt;add user&amp;lt;/a&amp;gt;&lt;br&gt;  &amp;lt;br&amp;gt;&amp;lt;a href="http://serv02.example.com/manageUsers.do"&amp;gt;manage users&amp;lt;/a&amp;gt;&lt;br&gt;  &amp;lt;br&amp;gt;  &amp;lt;p&amp;gt;&amp;lt;a href="http://serv02.example.com/logout.do"&amp;gt;log out&amp;lt;/a&amp;gt;&amp;lt;p&amp;gt;&amp;lt;/td&amp;gt;&lt;/pre&gt;&lt;h1&gt;Related Guideline&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="ruledisplay:31529619-FB94-4798-BB29-14AC389F2240"&gt;Guideline: Separate Account Administration from the Main Application Interface (Java Web Application)&lt;/a&gt; &lt;/li&gt;&lt;/ul&gt;</content>
</guidanceItem>