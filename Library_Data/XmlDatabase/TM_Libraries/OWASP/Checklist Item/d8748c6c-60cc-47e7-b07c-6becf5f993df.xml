<?xml version="1.0" encoding="utf-8"?>
<guidanceItem id="d8748c6c-60cc-47e7-b07c-6becf5f993df" Author="" Category="Authorization" Priority="2" Rule_Type="Checklist Item" Status="" Technology="Java" title="Inactive User Accounts Are Automatically Locked" Topic="Security" phase="Design" xmlns="urn:microsoft:guidanceexplorer:guidanceItem">
  <content>&lt;h1&gt;What to Check For&lt;/h1&gt;&lt;p&gt;Ensure the application automatically locks inactive user accounts. Verify that all instances of locking inactive accounts are logged.&lt;/p&gt;&lt;h1&gt;Why&lt;/h1&gt;&lt;p&gt;Inactive user accounts increase the attack surface of the application and can be used by an attacker as a means of entry.&lt;/p&gt;&lt;h1&gt;How to Check&lt;/h1&gt;&lt;p&gt;Follow these steps during the design phase to make sure your application has the capability to lock its inactive user accounts:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Verify your application stores the user's last login/inactivity information. &lt;/strong&gt;Check if your application has the necessary procedures in place to store and retrieve last login and lockout information about its users. Common locations for storing such information are:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Database that stores user account information &lt;/li&gt;&lt;li&gt;Data structures (e.g. Java class) that represent user accounts &lt;/li&gt;&lt;li&gt;Routines that handle user login &lt;/li&gt;&lt;li&gt;Routines that retrieve and update user account information&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Verify your application has a lockout policy. &lt;/strong&gt;An account lockout policy is typically application specific. Review your application's requirements and design specifications. Check for the following functionality:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;A mechanism for determining user inactivity &lt;/li&gt;&lt;li&gt;A mechanism for locking inactive accounts &lt;/li&gt;&lt;li&gt;A mechanism for unlocking disabled accounts &lt;/li&gt;&lt;li&gt;Verify that the last-login timestamp is reset to the current timestamp upon a successful authentication attempt&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Verify the lockout policy is enforced by default. &lt;/strong&gt;Make sure the functionality that enforces the lockout policy is enabled by default during deployment. &lt;/p&gt;&lt;ul&gt;&lt;li&gt;Ensure that only users with administrative privileges can amend your application's lockout policy. &lt;/li&gt;&lt;li&gt;Verify that all instances of modifying the lockout policy are logged. &lt;/li&gt;&lt;li&gt;Check the following locations in the code to determine if the lockout policy is fully enforced: &lt;ul&gt;&lt;li&gt;Account administration routines &lt;/li&gt;&lt;li&gt;Background database processes that perform user account maintenance &lt;/li&gt;&lt;li&gt;Authentication routines&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h1&gt;Problem Example&lt;/h1&gt;&lt;p&gt;The following segment illustrates the user database of a multi-user application. In its current state, the application logs the last time the user has logged in but does not enforce a lockout policy for its inactive users; therefore, an attacker can gain unauthorized access to the application by compromising an inactive account.&lt;/p&gt;&lt;pre&gt;sql&amp;gt; select username, locked, last_login_date from users;&lt;br&gt;+----------+--------+-----------------+&lt;br&gt;| username | locked | last_login_date |&lt;br&gt;+----------+--------+-----------------+&lt;br&gt;| adam     |      0 |      2006-10-11 |&lt;br&gt;| sue      |      0 |      2006-10-11 |&lt;br&gt;| jim      |      0 |      2006-10-01 |&lt;br&gt;| richard  |      0 |      2006-10-01 |&lt;br&gt;| julie    |      0 |      2006-09-23 |&lt;br&gt;| sam      |      0 |      2006-06-23 |&lt;br&gt;+----------+--------+-----------------+&lt;/pre&gt;&lt;h1&gt;Related Guideline&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="ruledisplay:45CAB29F-B502-4524-B054-D507AD601748"&gt;Guideline: Automatically Lock Inactive User Accounts (Java Web Application)&lt;/a&gt; &lt;/li&gt;&lt;/ul&gt;</content>
</guidanceItem>