<?xml version="1.0" encoding="utf-8"?>
<guidanceItem id="21887be9-a2c6-4d6d-89e9-ea8c20daaf4e" Author="" Category="Authentication" Priority="2" Rule_Type="Checklist Item" Status="" Technology="ASP.NET 3.5" title="Authentication Cookies Are Not Persisted" Topic="Security" phase="Implementation" xmlns="urn:microsoft:guidanceexplorer:guidanceItem">
  <content>&lt;h1&gt;What to Check For&lt;/h1&gt;&lt;p&gt;Ensure that&amp;nbsp;authentication cookies are not stored in the user's profile.&lt;/p&gt;&lt;h1&gt;Why&lt;/h1&gt;&lt;p&gt;Stored authentication cookies&amp;nbsp;can be stolen if an attacker gets physical access to the user's computer. &lt;/p&gt;&lt;h1&gt;How to Fix&lt;/h1&gt;&lt;p&gt;To ensure a non-persistent cookie, set the &lt;strong&gt;DisplayRememberMe&lt;/strong&gt; property of the &lt;strong&gt;Login&lt;/strong&gt; control to &lt;strong&gt;false&lt;/strong&gt;.&lt;/p&gt;&lt;p&gt;If you are not using the login controls, you can specify a non-persistent cookie when you call either the &lt;strong&gt;RedirectFromLoginPage&lt;/strong&gt; or &lt;strong&gt;SetAuthCookie&lt;/strong&gt; methods of the &lt;strong&gt;FormsAuthentication&lt;/strong&gt; class having validated the user's credentials, as shown here:&lt;/p&gt;
&lt;pre&gt;public void Login_Click(object sender, EventArgs e)&lt;/pre&gt;&lt;pre&gt;{&lt;br&gt;   // Is the user valid?&lt;br&gt;   if (Membership.ValidateUser(userName.Text, password.Text))&lt;br&gt;   {&lt;br&gt;        // Parameter two set to false indicates non-persistent cookie&lt;br&gt;        FormsAuthentication.RedirectFromLoginPage(username.Text, false);&lt;br&gt;    }&lt;br&gt;    else&lt;br&gt;    {&lt;br&gt;        Status.Text = "Invalid credentials. Please try again.";&lt;br&gt;    }&lt;br&gt;}&lt;/pre&gt;&lt;br&gt;&lt;hr&gt;&lt;p&gt;Adapted from Microsoft patterns &amp;amp; practices guidance. &lt;/p&gt;</content>
</guidanceItem>