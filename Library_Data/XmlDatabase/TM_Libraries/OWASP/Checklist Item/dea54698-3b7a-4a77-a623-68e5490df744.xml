<?xml version="1.0" encoding="utf-8"?>
<guidanceItem id="dea54698-3b7a-4a77-a623-68e5490df744" Author="" Category="Authentication" Priority="2" Rule_Type="Checklist Item" Status="" Technology="Java" title="SSL Is Used When Transmitting Credentials" Topic="Security" phase="Implementation" xmlns="urn:microsoft:guidanceexplorer:guidanceItem">
  <content>&lt;h1&gt;What to Check For&lt;/h1&gt;&lt;p&gt;Ensure that SSL&amp;nbsp;is used when transmitting credentials and never unencrypted connections.&lt;/p&gt;&lt;h1&gt;Why&lt;/h1&gt;&lt;p&gt;Using SSL prevents the credentials from being&amp;nbsp;identified or tampered with as they are transmitted over the network.&lt;/p&gt;&lt;h1&gt;How to Check&lt;/h1&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Verify that a dedicated SSL-enabled server is used for the authentication component of your application. &lt;/strong&gt;Ensure that your application's authentication component runs on a dedicated subdomain and a server that accepts only HTTPS traffic. Disallowing unencrypted HTTP connections will prevent accidental or malicious unsecured connections. Check that the server uses valid SSLv3 certificates that have been signed by a trusted certification authority. Disallowing lower SSL versions, such as SSLv1 and SSLv2 will ensure that weaker encryption methods can not be exploited by an attacker.&lt;br&gt;&lt;br&gt;The following URL should connect and prompt for login credentials:&lt;/p&gt;&lt;blockquote&gt;&lt;pre&gt;https://login.example.com/myapp/login&lt;/pre&gt;&lt;/blockquote&gt;&lt;p&gt;An HTTP URL to the same server and component should either be disallowed or redirect to its HTTPS counterpart:&lt;/p&gt;&lt;blockquote&gt;&lt;pre&gt;http://login.example.com/myapp/login&lt;/pre&gt;&lt;/blockquote&gt;&lt;p&gt;For more information, consult &lt;a href="http://java.sun.com/j2ee/1.4/docs/tutorial-update2/doc/Security6.html#wp509934"&gt;Secure Socket Layer in the J2EE&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Identify forms that send credentials. &lt;/strong&gt;Forms are defined by a &lt;strong&gt;&amp;lt;form&amp;gt;&lt;/strong&gt; tag in the HTML document, such as the one below:&lt;/p&gt;&lt;blockquote&gt;&lt;pre&gt;&amp;lt;form method="POST" action="https://login.example.com/myapp/login"&amp;gt;&lt;/pre&gt;&lt;/blockquote&gt;&lt;p&gt;Forms that include credentials usually, but won't always, include an input field with a &lt;strong&gt;TYPE&lt;/strong&gt; attribute set to &lt;strong&gt;password&lt;/strong&gt;:&lt;/p&gt;&lt;blockquote&gt;&lt;pre&gt;&amp;lt;input &lt;strong&gt;type&lt;/strong&gt;="&lt;strong&gt;password&lt;/strong&gt;" name="pass" size=25&amp;gt;&lt;/pre&gt;&lt;/blockquote&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Ensure that form data is sent using HTTPS. &lt;/strong&gt;Examine the &lt;strong&gt;ACTION&lt;/strong&gt; attribute of the &lt;strong&gt;&amp;lt;form&amp;gt;&lt;/strong&gt; tag and ensure it posts to an absolute URL path and includes HTTPS in the URL, as shown below: &lt;/p&gt;&lt;blockquote&gt;&lt;pre&gt;&amp;lt;form method="POST" &lt;strong&gt;action&lt;/strong&gt;="&lt;strong&gt;https&lt;/strong&gt;://login.example.com/myapp/login"&amp;gt;&lt;/pre&gt;&lt;/blockquote&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h1&gt;Problem Example&lt;/h1&gt;&lt;p&gt;In the following snippet, the credentials are transmitted over unprotected HTTP. This allows an attacker to easily sniff the traffic and steal the credentials.&lt;/p&gt;&lt;br&gt;&lt;blockquote&gt;&lt;pre&gt;&amp;lt;html&amp;gt;&lt;br&gt;  &amp;lt;head&amp;gt;&lt;br&gt;    &amp;lt;title&amp;gt;login form&amp;lt;/title&amp;gt;&lt;br&gt;  &amp;lt;/head&amp;gt;&lt;br&gt;  &amp;lt;body&amp;gt;&lt;br&gt;    &amp;lt;form method="POST" action="http://login.example.com/myapp/login"&amp;gt;&lt;br&gt;    &amp;lt;input type="text" name="user" size=25&amp;gt;&amp;lt;br&amp;gt;&lt;br&gt;    &amp;lt;input type="password" name="pass" size=25&amp;gt;&amp;lt;br&amp;gt;&lt;br&gt;    &amp;lt;input type="submit" name="submit" value="log in"&amp;gt;&lt;br&gt;    &amp;lt;/form&amp;gt;&lt;br&gt;  &amp;lt;/body&amp;gt;&lt;br&gt;&amp;lt;/html&amp;gt;&lt;/pre&gt;&lt;/blockquote&gt;&lt;h1&gt;Related Guideline&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="ruledisplay:ED6F49C0-E021-459E-AE4F-9116CA8E8073"&gt;Guideline: Use SSL When Transmitting Credentials (Java Web Application)&lt;/a&gt; &lt;/li&gt;&lt;/ul&gt;</content>
</guidanceItem>