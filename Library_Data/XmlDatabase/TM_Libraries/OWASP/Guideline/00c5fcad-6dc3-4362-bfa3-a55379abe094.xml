<?xml version="1.0" encoding="utf-8"?>
<guidanceItem id="00c5fcad-6dc3-4362-bfa3-a55379abe094" Author="" Category="Input and Data Validation" Priority="J.D. Meier, Alex Mackman, Michael Dunner, Srinath Vasireddy, Ray Escamilla and Anandha Murukan" Rule_Type="Guideline" Status="" Technology=" Any" title="Validate All Values Sent from the Client" Topic="Security" phase="Design" xmlns="urn:microsoft:guidanceexplorer:guidanceItem">
  <content>&lt;h1&gt;Applies to&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;&lt;div&gt;Web Application&lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h1&gt;What to Do&lt;/h1&gt;&lt;p&gt;Check that your application validates all input parameters, including regular and hidden form fields, query strings, and cookies.&lt;/p&gt;&lt;h1&gt;Why&lt;/h1&gt;&lt;p&gt;To protect your application from denial of service attacks and code injection attacks, including SQL injection and XSS.&lt;/p&gt;&lt;h1&gt;When&lt;/h1&gt;&lt;p&gt;This is an important guideline and should be followed all the time.&amp;nbsp;&lt;/p&gt;&lt;h1&gt;How&lt;/h1&gt;&lt;p&gt;Restrict the fields that the user can enter and modify and validate all values coming from the client. If you have predefined values in your form fields, users can change them and post them back to receive different results. Permit only known good values wherever possible. For example, if the input field is for a state, only inputs matching a state postal code should be permitted.&lt;/p&gt;&lt;p&gt;The &lt;strong&gt;System.Text.RegularExpressions.Regex&lt;/strong&gt; class helps validate input parameters. For example, the following code shows how to use this class to validate a name passed through a query string parameter. The same technique can be used to validate other forms of input parameter, for example, from cookies or form fields. For example, to validate a cookie parameter, use &lt;strong&gt;Request.Cookies&lt;/strong&gt; instead of &lt;strong&gt;Request.QueryString&lt;/strong&gt;.&lt;/p&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;pre&gt;using System.Text.RegularExpressions;&lt;br&gt;. . .&lt;br&gt;private void Page_Load(object sender, System.EventArgs e)&lt;br&gt;{&lt;br&gt;&amp;nbsp; // Name must contain between 1 and 40 alphanumeric characters&lt;br&gt;&amp;nbsp; // together with (optionally) special characters '`´ for names such&lt;br&gt;&amp;nbsp; // as D'Angelo&lt;br&gt;&amp;nbsp; if (!Regex.IsMatch(Request.QueryString["name"], &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; @"^[a-zA-Z'`-´\s]{1,40}$"))&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; throw new Exception("Invalid name parameter");&lt;br&gt;&amp;nbsp; // Use individual regular expressions to validate all other&lt;br&gt;&amp;nbsp; // query string parameters&lt;br&gt;&amp;nbsp; . . .&lt;br&gt;}&lt;br&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;p&gt;For more information about using regular expressions and how to validate input data, see "&lt;a href="http://msdn2.microsoft.com/en-us/library/aa302426.aspx#c10618429_006"&gt;Input Validation&lt;/a&gt;".&lt;/p&gt;&lt;h1&gt;Additional Resources&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;For more information see, "Chapter 4 - Design Guidelines for Secure Web Applications" at &lt;a href="http://msdn2.microsoft.com/en-us/library/aa302420.aspx"&gt;http://msdn2.microsoft.com/en-us/library/aa302420.aspx&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;hr&gt;&lt;p&gt;Adapted from Microsoft patterns &amp;amp; practices guidance.&lt;/p&gt;</content>
</guidanceItem>