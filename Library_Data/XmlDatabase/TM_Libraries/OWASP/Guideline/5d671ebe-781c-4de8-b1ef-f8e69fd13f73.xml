<?xml version="1.0" encoding="utf-8"?>
<guidanceItem id="5d671ebe-781c-4de8-b1ef-f8e69fd13f73" Author="" Category="Authorization" Priority="2" Rule_Type="Guideline" Status="" Technology="ASP.NET 3.5" title="Restrict All Role Caching Cookies to HTTPS Connections" Topic="Security" phase="Implementation" xmlns="urn:microsoft:guidanceexplorer:guidanceItem">
  <content>&lt;h1&gt;What to Do&lt;/h1&gt;&lt;p&gt;Use the &lt;strong&gt;cookieRequireSSL&lt;/strong&gt; attribute to restrict role caching cookies to HTTPS connections if role caching is being used. &lt;/p&gt;&lt;h1&gt;Why&lt;/h1&gt;&lt;p&gt;Sending cookies out exclusively over SSL makes it much harder for an attacker to sniff the cookie values off the wire.&amp;nbsp; If an attacker can get a copy of an authorization cookie, they can potentially emulate that role, allowing them to elevate their privilege in the system. &lt;/p&gt;&lt;h1&gt;When&lt;/h1&gt;&lt;p&gt;All systems which use authorization cookies should use SSL for those cookies if at all possible.&amp;nbsp; Systems which deal with any personally identifiable information or monetary transaction should use SSL in all circumstances without exception. &lt;/p&gt;&lt;h1&gt;How&lt;/h1&gt;&lt;p&gt;Set the &lt;strong&gt;cookieRequireSSL&lt;/strong&gt; attribute to true to specify that the authorization cookie with the role information should only be returned to the server over HTTPS connections.&amp;nbsp; The following example shows a &lt;strong&gt;&amp;lt;roleManager&amp;gt;&lt;/strong&gt; element configured to protect the authorization cookie. &lt;/p&gt;&lt;pre&gt;&amp;lt;roleManager enabled="true"             &lt;br&gt;  cacheRolesInCookie="true"             &lt;br&gt;  cookieName=".ASPROLES"             &lt;br&gt;  cookieTimeout="30"             &lt;br&gt;  cookiePath="/"             &lt;br&gt;  cookieRequireSSL="true"             &lt;br&gt;  cookieSlidingExpiration="true"             &lt;br&gt;  cookieProtection="All"              &lt;br&gt;  createPersistentCookie="false"&amp;gt;&lt;br&gt;&amp;lt;/roleManager&amp;gt;&lt;/pre&gt;&lt;h1&gt;Related Items&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="ruledisplay:24e081c4-0c62-4c93-a91a-42a96892d74d"&gt;Use Role Caching if Role Store Lookups are too Costly&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;hr&gt;&lt;p&gt;Adapted from Microsoft patterns &amp;amp; practices guidance. &lt;/p&gt;</content>
</guidanceItem>