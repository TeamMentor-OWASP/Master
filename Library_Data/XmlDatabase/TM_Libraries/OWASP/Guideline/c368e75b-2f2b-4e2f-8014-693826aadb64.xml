<?xml version="1.0" encoding="utf-8"?>
<guidanceItem id="c368e75b-2f2b-4e2f-8014-693826aadb64" Author="" Category="Authentication" Priority="J.D. Meier, Alex Mackman, Michael Dunner, Srinath Vasireddy, Ray Escamilla and Anandha Murukan" Rule_Type="Guideline" Status="" Technology=" Any" title="Support Account Management" Topic="Security" phase="Design" xmlns="urn:microsoft:guidanceexplorer:guidanceItem">
  <content>&lt;h1&gt;Applies to&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;Web Application&amp;nbsp;&lt;/li&gt;&lt;/ul&gt;&lt;h1&gt;What to Do&lt;/h1&gt;&lt;p&gt;Ensure that the code enforce password complexity rules and restricts the number of failed logon attempts. &lt;/p&gt;&lt;h1&gt;Why&lt;/h1&gt;&lt;p&gt;Restricting the number of failed login attempts helps to counter the threat of dictionary attacks. &lt;/p&gt;&lt;h1&gt;When&lt;/h1&gt;&lt;p&gt;The use of strong passwords, restricted login attempts, and other best practice account management policies can be enforced by Windows security policy if your application uses Windows authentication. Otherwise, the application layer is responsible for this. &lt;/p&gt;&lt;h1&gt;How&lt;/h1&gt;&lt;h2&gt;Use Account Lockout Policies for End-User Accounts&lt;/h2&gt;&lt;p&gt;Disable end-user accounts or write events to a log after a set number of failed logon attempts. If you are using Windows authentication, such as NTLM or the Kerberos protocol, these policies can be configured and applied automatically by the operating system. With Forms authentication, these policies are the responsibility of the application and must be incorporated into the application design.&lt;/p&gt;&lt;p&gt;Be careful that account lockout policies cannot be abused in denial of service attacks. For example, well known default service accounts such as IUSR_MACHINENAME should be replaced by custom account names to prevent an attacker who obtains the Internet Information Services (IIS) Web server name from locking out this critical account.&lt;/p&gt;&lt;h2&gt;Be Able to Disable Accounts&lt;/h2&gt;&lt;p&gt;If the system is compromised, being able to deliberately invalidate credentials or disable accounts can prevent additional attacks.&lt;/p&gt;&lt;p&gt;The use of strong passwords, restricted login attempts, and other best practice account management policies can be enforced by Windows security policy if your application uses Windows authentication. Otherwise, the application layer is responsible for this. Review the following aspects of the account management of your application: &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;strong&gt;Does your application enforce strong passwords?&lt;/strong&gt; &lt;p&gt;For example, do your ASP.NET Web pages use regular expressions to verify password complexity rules? &lt;/p&gt;&lt;blockquote&gt;&lt;strong&gt;Note&lt;/strong&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;If you are using the Membership feature of ASP.NET 2.0, you can configure the providers to enforce strong passwords. For more information, see "&lt;a href="http://msdn.microsoft.com/library/en-us/dnpag2/html/paght000012.asp"&gt;How To: Protect Forms Authentication in ASP.NET 2.0&lt;/a&gt;".&lt;/blockquote&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Do you restrict the number of failed login attempts?&lt;/strong&gt; &lt;p&gt;Doing so can help counter the threat of dictionary attacks. &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Do you reveal too much information in the event of failure?&lt;/strong&gt; &lt;p&gt;Make sure you do not display messages such as "Incorrect password" because this tells malicious users that the user name is correct. This allows them to focus their efforts on cracking passwords. &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Do you enforce a periodic change of passwords?&lt;/strong&gt; &lt;p&gt;This is recommended because otherwise there is a high probability that a user will not change his or her password, which makes it more vulnerable. &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Can you quickly disable accounts in the event of compromise?&lt;/strong&gt; &lt;p&gt;If an account is compromised, can you easily disable the account to prevent the attacker from continuing to use the account? &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Does your application record login attempts?&lt;/strong&gt; &lt;p&gt;Recording failed login attempts is an effective way to detect an attacker who is attempting to break in. &lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h1&gt;Additional Resources&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;Design Guidelines for Secure Web Applications &lt;a href="http://msdn2.microsoft.com/en-us/library/aa302420.aspx"&gt;http://msdn2.microsoft.com/en-us/library/aa302420.aspx&lt;/a&gt; &lt;/li&gt;&lt;li&gt;Architecture and Design Review for Security &lt;a href="http://msdn2.microsoft.com/en-us/library/aa302420.aspx"&gt;http://msdn2.microsoft.com/en-us/library/aa302420.aspx&lt;/a&gt; &lt;/li&gt;&lt;li&gt;Securing Your ASP.NET Application and Web Services &lt;a href="http://msdn2.microsoft.com/en-us/library/aa302435.aspx"&gt;http://msdn2.microsoft.com/en-us/library/aa302435.aspx&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;hr&gt;&lt;p&gt;Adapted from Microsoft patterns &amp;amp; practices guidance.&lt;/p&gt;</content>
</guidanceItem>