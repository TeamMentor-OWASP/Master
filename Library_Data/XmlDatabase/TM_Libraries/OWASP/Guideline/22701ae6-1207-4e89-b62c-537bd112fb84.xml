<?xml version="1.0" encoding="utf-8"?>
<guidanceItem id="22701ae6-1207-4e89-b62c-537bd112fb84" Author="" Category="Deployment Considerations" Priority="2" Rule_Type="Guideline" Status="" Technology="Java" title="Disable Directory Browsing" Topic="Security" phase="Deployment" xmlns="urn:microsoft:guidanceexplorer:guidanceItem">
  <content>&lt;h1&gt;Applies to&lt;/h1&gt;&lt;p&gt;Applications written using Servlets or JSP.&lt;/p&gt;&lt;h1&gt;What to Do&lt;/h1&gt;&lt;p&gt;Disable directory browsing for your application's web directories.&lt;/p&gt;&lt;h1&gt;Why&lt;/h1&gt;&lt;p&gt;Directory browsing allows an attacker to browse your application's directory structure in search of unprotected files and components.&lt;/p&gt;&lt;h1&gt;When&lt;/h1&gt;&lt;p&gt;Disable directory browsing at all times.&lt;/p&gt;&lt;h1&gt;How&lt;/h1&gt;&lt;p&gt;Use the following steps to successfully disable directory browsing:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Identify if directory browsing is enabled. &lt;/strong&gt;Navigate to your application's directories. Identify&amp;nbsp;whether your application's server correctly returns an HTTP error message. If it incorrectly returns&amp;nbsp;the directory contents, continue with the following steps.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Locate the default servlet's configuration. &lt;/strong&gt;Open your application's deployment descriptor (e.g. web.xml), and locate the default servlet's configuration. If the default servlet is present, it is mapped to the root directory of your application. Example: &lt;/p&gt;&lt;blockquote&gt;&lt;pre&gt;&amp;lt;servlet&amp;gt;&lt;br&gt;      &amp;lt;servlet-name&amp;gt;default_servlet&amp;lt;/servlet-name&amp;gt;&lt;br&gt;      &amp;lt;servlet-class&amp;gt;&lt;br&gt;            org.apache.catalina.servlets.DefaultServlet&lt;br&gt;      &amp;lt;/servlet-class&amp;gt;&lt;br&gt;&amp;lt;/servlet&amp;gt;&lt;br&gt;&amp;lt;servlet-mapping&amp;gt;&lt;br&gt;      &amp;lt;servlet-name&amp;gt;default_servlet&amp;lt;/servlet-name&amp;gt;&lt;br&gt;      &amp;lt;url-pattern&amp;gt;/&amp;lt;/url-pattern&amp;gt;&lt;br&gt;&amp;lt;/servlet-mapping&amp;gt;&lt;/pre&gt;&lt;/blockquote&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Deny directory browsing in the default servlet's configuration. &lt;/strong&gt;Initialize the default servlet with the parameter &lt;strong&gt;listings&lt;/strong&gt; set to &lt;strong&gt;false&lt;/strong&gt;. Example:&lt;/p&gt;&lt;blockquote&gt;&lt;pre&gt;&amp;lt;servlet&amp;gt;&lt;br&gt;      &amp;lt;servlet-name&amp;gt;default_servlet&amp;lt;/servlet-name&amp;gt;&lt;br&gt;      &amp;lt;servlet-class&amp;gt;&lt;br&gt;            org.apache.catalina.servlets.DefaultServlet&lt;br&gt;      &amp;lt;/servlet-class&amp;gt;&lt;br&gt;      &lt;strong&gt;&amp;lt;init-param&amp;gt;&lt;br&gt;&lt;/strong&gt;            &amp;lt;param-name&amp;gt;listings&amp;lt;/param-name&amp;gt;&lt;br&gt;            &amp;lt;param-value&amp;gt;false&amp;lt;/param-value&amp;gt;&lt;br&gt;&lt;strong&gt;      &amp;lt;/init-param&amp;gt;&lt;br&gt;&lt;/strong&gt;&amp;lt;/servlet&amp;gt;&lt;br&gt;&amp;lt;servlet-mapping&amp;gt;&lt;br&gt;      &amp;lt;servlet-name&amp;gt;default_servlet&amp;lt;/servlet-name&amp;gt;&lt;br&gt;      &amp;lt;url-pattern&amp;gt;/&amp;lt;/url-pattern&amp;gt;&lt;br&gt;&amp;lt;/servlet-mapping&amp;gt;&lt;/pre&gt;&lt;/blockquote&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h1&gt;Problem Example&lt;/h1&gt;&lt;p&gt;An application is deployed on a production server. Unfortunately, the developers did not disable directory browsing. This allows an attacker to search for unprotected configuration files.&lt;/p&gt;&lt;h1&gt;Solution Example&lt;/h1&gt;&lt;p&gt;An application is deployed on a production server. Because the developers have disabled directory browsing, it is impossible for an attacker to use HTTP browsing to search for unprotected configuration files.&lt;/p&gt;&lt;h1&gt;Related Items&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="ruledisplay:E99B2092-A623-447A-8461-1FD8F860AA15"&gt;Guideline: Remove Test Interfaces (Java Web Application)&lt;/a&gt; &lt;/li&gt;&lt;li&gt;&lt;a href="ruledisplay:4572037A-2166-4AD1-8E73-D623E468A7B9"&gt;Attack: Information Disclosure Attack&lt;/a&gt; &lt;/li&gt;&lt;li&gt;&lt;a href="ruledisplay:1D7F6072-1A5F-472E-9D27-F15E396EAB2E"&gt;Attack: Forceful Browsing Attack&lt;/a&gt; &lt;/li&gt;&lt;li&gt;&lt;a href="ruledisplay:1398DA02-651D-4798-95C3-7C3F8409004B"&gt;Checklist Item: Directory Browsing is Disabled (Java Web Application)&lt;/a&gt; &lt;/li&gt;&lt;/ul&gt;</content>
</guidanceItem>