<?xml version="1.0" encoding="utf-8"?>
<guidanceItem id="e322d018-d2f1-4c5c-9c41-288b4b7155f1" Author="" Category="Authentication" Priority="2" Rule_Type="Guideline" Status="" Technology="Java" title="Use SSL When Transmitting Credentials" Topic="Security" phase="Implementation" xmlns="urn:microsoft:guidanceexplorer:guidanceItem">
  <content>&lt;h1&gt;Applies to&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;Applications written using Servlets or JSP.&lt;/li&gt;&lt;/ul&gt;&lt;h1&gt;What to Do&lt;/h1&gt;&lt;p&gt;Do not send credentials via unencrypted connections. Use SSL when transmitting credentials.&lt;/p&gt;&lt;h1&gt;Why&lt;/h1&gt;&lt;p&gt;Using SSL prevents the credentials from being sniffed or tampered with as they are transmitted over the network.&lt;/p&gt;&lt;h1&gt;When&lt;/h1&gt;&lt;p&gt;If your application sends credentials on the Internet.&lt;/p&gt;&lt;h1&gt;How&lt;/h1&gt;&lt;p&gt;Using Secure Socket Layer (SSL) over HTTP requires the following steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Create a certificate request.&lt;/strong&gt; Using your hosting server or OpenSSL, generate an SSL certificate request. Example:&lt;/p&gt;&lt;blockquote&gt;&lt;pre&gt;# Generate private key&lt;br&gt;openssl genrsa -des3 -out privkey.pem 2048 &lt;br&gt;# Generate certificate request using private key&lt;br&gt;openssl req -new -key privkey.pem -out cert.csr&lt;/pre&gt;&lt;/blockquote&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Present the request to a Certification Authority (CA).&lt;/strong&gt; If all conditions for obtaining an SSL certificate are met, the CA will produce a new SSL certificate based on the certificate request. Because the requirements for obtaining an SSL certificate depend on the Certification Authority, consult with the Certification Authority in regards to the administrative steps necessary for obtaining such certificate.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Install the certificate.&lt;/strong&gt; Consult with the hosting server's documentation on how to install the SSL certificate.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;Ensure credentials are sent over SSL.&lt;/strong&gt; Place the authentication portion of your application on a dedicated subdomain. Configure the server to accept only HTTPS traffic for the authentication subdomain. Ensure that form posts containing credentials are sent over HTTPS. This is accomplished by using absolute URL paths in the action field. Example:&lt;/p&gt;&lt;blockquote&gt;&lt;pre&gt;&amp;lt;form method="POST" action="https://login.example.com/myapp/login"&amp;gt;&lt;/pre&gt;&lt;/blockquote&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h1&gt;Problem Example&lt;/h1&gt;&lt;p&gt;In the following snippet, the credentials are transmitted over unprotected HTTP. This allows an attacker to easily steal credentials from sniffed traffic.&lt;/p&gt;&lt;blockquote&gt;&lt;pre&gt;&amp;lt;html&amp;gt;&lt;br&gt;  &amp;lt;head&amp;gt;&lt;br&gt;    &amp;lt;title&amp;gt;login form&amp;lt;/title&amp;gt;&lt;br&gt;  &amp;lt;/head&amp;gt;&lt;br&gt;  &amp;lt;body&amp;gt;&lt;br&gt;    &amp;lt;form method="POST" action="http://login.example.com/myapp/login"&amp;gt;&lt;br&gt;    &amp;lt;input type="text" name="user" size=25&amp;gt;&amp;lt;br&amp;gt;&lt;br&gt;    &amp;lt;input type="password" name="pass" size=25&amp;gt;&amp;lt;br&amp;gt;&lt;br&gt;    &amp;lt;input type="submit" name="submit" value="log in"&amp;gt;&lt;br&gt;    &amp;lt;/form&amp;gt;&lt;br&gt;  &amp;lt;/body&amp;gt;&lt;br&gt;&amp;lt;/html&amp;gt;&lt;/pre&gt;&lt;/blockquote&gt;&lt;h1&gt;Solution Example&lt;/h1&gt;&lt;p&gt;In the following snippet, the credentials are transmitted over HTTPS. This makes it difficult for an attacker to steal credentials from sniffed traffic:&lt;/p&gt;&lt;blockquote&gt;&lt;pre&gt;&amp;lt;html&amp;gt;&lt;br&gt;  &amp;lt;head&amp;gt;&lt;br&gt;    &amp;lt;title&amp;gt;login form&amp;lt;/title&amp;gt;&lt;br&gt;  &amp;lt;/head&amp;gt;&lt;br&gt;  &amp;lt;body&amp;gt;&lt;br&gt;    &amp;lt;form method="POST" action="https://login.example.com/myapp/login"&amp;gt;&lt;br&gt;    &amp;lt;input type="text" name="user" size=25&amp;gt;&amp;lt;br&amp;gt;&lt;br&gt;    &amp;lt;input type="password" name="pass" size=25&amp;gt;&amp;lt;br&amp;gt;&lt;br&gt;    &amp;lt;input type="submit" name="submit" value="log in"&amp;gt;&lt;br&gt;    &amp;lt;/form&amp;gt;&lt;br&gt;  &amp;lt;/body&amp;gt;&lt;br&gt;&amp;lt;/html&amp;gt;&lt;/pre&gt;&lt;/blockquote&gt;&lt;h1&gt;Additional Resources&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;For more information about using SSL in the J2EE, see: &lt;a href="http://www.cs.uccs.edu/~cs301/j2ee/j2eetutorial14/doc/Security6.html"&gt;Installing and Configuring SSL Support&lt;/a&gt;. &lt;/li&gt;&lt;li&gt;To learn more about generating certificate requests, see: &lt;a href="http://support.microsoft.com/default.aspx?scid=KB;en-us;q228821"&gt;Generating a Certificate Request File Using the Certificate Wizard in IIS 5.0&lt;/a&gt;. &lt;/li&gt;&lt;li&gt;To learn more about creating SSL certificates, see: &lt;a href="http://www.openssl.org/docs/HOWTO/certificates.txt"&gt;OpenSSL HOWTO certificates&lt;/a&gt;. &lt;/li&gt;&lt;li&gt;For more information about using SSL with Tomcat, see: &lt;a href="http://tomcat.apache.org/tomcat-4.0-doc/ssl-howto.html"&gt;SSL Configuration HOW-TO&lt;/a&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;h1&gt;Related Items&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="ruledisplay:024B6044-7C89-436C-8111-1B6FAE7298AC"&gt;Guideline: Protect Sensitive Data Over the Network (Java Web Application)&lt;/a&gt; &lt;/li&gt;&lt;li&gt;&lt;a href="ruledisplay:F0E2BFFC-E6D1-4DC6-A6C2-D078F54AE10E"&gt;Guideline: Protect Session Cookies (Java Web Application)&lt;/a&gt; &lt;/li&gt;&lt;li&gt;&lt;a href="ruledisplay:B47A6486-A73E-44B9-AD17-1F7F94199828"&gt;Attack: Network Credential Sniffing Attack&lt;/a&gt; &lt;/li&gt;&lt;li&gt;&lt;a href="ruledisplay:9E3FC30A-B55C-4AF6-8B77-A534C6F87197"&gt;Attack: Phishing Attack&lt;/a&gt; &lt;/li&gt;&lt;li&gt;&lt;a href="ruledisplay:4572037A-2166-4AD1-8E73-D623E468A7B9"&gt;Attack: Information Disclosure Attack&lt;/a&gt; &lt;/li&gt;&lt;li&gt;&lt;a href="ruledisplay:B446B34C-8DEC-4F74-A392-C30D1719D90D"&gt;Attack: Trust Relationship Attack&lt;/a&gt; &lt;/li&gt;&lt;li&gt;&lt;a href="ruledisplay:48BB4D3A-9295-4263-B3E7-090E483DEC5D"&gt;Attack: Man in the Middle Attack&lt;/a&gt; &lt;/li&gt;&lt;li&gt;&lt;a href="ruledisplay:51CDBB59-211B-4816-896D-319D42D3FCE2"&gt;Checklist Item: SSL is Used When Transmitting Credentials (Java Web Application)&lt;/a&gt; &lt;/li&gt;&lt;/ul&gt;</content>
</guidanceItem>